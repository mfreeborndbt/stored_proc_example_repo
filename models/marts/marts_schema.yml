version: 2

models:
  - name: fct_employee_campaign_events
    description: Fact table showing phishing simulation results at employee x campaign grain
    columns:
      - name: employee_campaign_event_key
        description: Surrogate key generated from pernr and campaign_id
        tests:
          - unique
          - not_null
      - name: pernr
        description: Employee personnel number
        tests:
          - not_null
      - name: campaign_id
        description: Campaign identifier
        tests:
          - not_null
      - name: campaign_name
        description: Campaign name
      - name: event_month
        description: Month of the campaign
      - name: final_event_type
        description: Final (worst) event type
      - name: business_unit
        description: Employee business unit
      - name: risk_level
        description: Risk level categorization
      - name: is_clicker
        description: Whether employee clicked or submitted data

  - name: fct_campaign_summary
    description: Campaign-level summary metrics
    columns:
      - name: campaign_summary_key
        description: Surrogate key generated from campaign_id and event_month
        tests:
          - unique
          - not_null
      - name: campaign_id
        description: Campaign identifier
        tests:
          - not_null
      - name: campaign_name
        description: Campaign name
      - name: total_employees_targeted
        description: Total number of employees targeted in this campaign
      - name: click_rate_pct
        description: Percentage of employees who clicked

  - name: fct_business_unit_summary
    description: Business unit level summary metrics
    columns:
      - name: business_unit_summary_key
        description: Surrogate key generated from business_unit and event_month
        tests:
          - unique
          - not_null
      - name: business_unit
        description: Business unit
        tests:
          - not_null
      - name: unique_employees
        description: Unique employees in this BU
      - name: click_rate_pct
        description: Percentage click rate
