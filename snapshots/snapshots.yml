version: 2

snapshots:
  - name: snap_campaign_summary
    relation: ref('fct_campaign_summary')
    config:
      strategy: check
      unique_key: campaign_id || '_' || event_month
      check_cols:
        - total_employees_targeted
        - employees_who_engaged
        - employees_data_submission
        - employees_clicked
        - employees_viewed
        - employees_reported
        - employees_no_action
        - total_clickers
        - critical_risk_count
        - high_risk_count
        - medium_risk_count
        - clickers_completed_training
        - clickers_not_completed_training
        - click_rate_pct
        - report_rate_pct
        - clicker_training_completion_rate_pct
      schema: snapshots
    description: Snapshot of campaign-level metrics to track performance changes over time
    
  - name: snap_business_unit_summary
    relation: ref('fct_business_unit_summary')
    config:
      strategy: check
      unique_key: business_unit || '_' || event_month
      check_cols:
        - unique_employees
        - campaigns_participated
        - total_campaign_participations
        - data_submissions
        - email_clicks
        - email_views
        - emails_reported
        - no_actions
        - total_click_incidents
        - unique_clickers
        - click_rate_pct
        - report_rate_pct
        - avg_event_severity_rank
      schema: snapshots
    description: Snapshot of business unit-level metrics to track performance changes over time

