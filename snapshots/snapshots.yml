version: 2

snapshots:
  - name: snap_workforce
    relation: source('phishing_demo', 'raw_workforce')
    config:
      strategy: check
      unique_key: pernr
      check_cols:
        - email
        - full_name
        - business_unit
        - department
        - title
        - employee_type
        - employment_status
        - location
        - manager_pernr
      schema: snapshots
    description: Snapshot of workforce data to track employee attribute changes over time
    
  - name: snap_training
    relation: source('phishing_demo', 'raw_training')
    config:
      strategy: check
      unique_key: pernr || '_' || learning_content || '_' || assigned_date
      check_cols:
        - due_date
        - completion_date
      schema: snapshots
    description: Snapshot of training assignments to track completion status changes

